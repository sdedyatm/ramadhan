<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0f172a">
  <title>CCTV Traffic Monitor</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.6.15/dist/hls.min.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

    body {
      font-family: 'Inter', sans-serif;
      background-color: #020617;
      height: 100vh;
      width: 100vw;
      margin: 0;
      display: flex;
      flex-direction: column;
    }

    /* Container Video */
    .video-viewport {
      background: radial-gradient(circle at center, #0f172a 0%, #020617 100%);
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
    }

    .video-container {
      width: 90%;
      max-width: 1000px;
      aspect-ratio: 16 / 9;
      background: #000;
      border-radius: 12px;
      overflow: hidden;
      position: relative;
      border: 1px solid #1e293b;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }

    /* Scrollbar Sidebar */
    .custom-scroll::-webkit-scrollbar {
      width: 6px;
    }

    .custom-scroll::-webkit-scrollbar-track {
      background: #0f172a;
    }

    .custom-scroll::-webkit-scrollbar-thumb {
      background: #334155;
      border-radius: 10px;
    }

    /* Menu Animasi */
    .submenu {
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .submenu.open {
      max-height: 2000px;
      opacity: 1;
      padding-bottom: 8px;
    }

    .status-dot {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: 0.4;
      }
    }
  </style>
</head>

<body class="text-slate-100 overflow-hidden">

  <header class="h-16 px-6 bg-slate-900/90 backdrop-blur-md border-b border-slate-800 flex items-center justify-between z-50 flex-shrink-0">
    <div class="flex items-center gap-3">
      <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center shadow-lg shadow-blue-500/20">
        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" stroke-width="2.5" />
        </svg>
      </div>
      <div>
        <h1 class="text-sm font-bold tracking-tighter uppercase leading-none">CCTV<span class="text-blue-500">LIVE</span></h1>
        <p class="text-[9px] text-emerald-400 font-mono tracking-widest mt-1">ATM SYSTEM ONLINE</p>
      </div>
    </div>
    <button onclick="app.toggleSettings()" class="p-2 hover:bg-slate-800 rounded-full transition-all">
      <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" stroke-width="2" />
      </svg>
    </button>
  </header>

  <main class="flex-1 flex flex-col lg:flex-row overflow-hidden">

    <section class="flex-grow bg-black relative flex flex-col min-h-0">
      <div class="video-viewport p-4 lg:p-10">
        <div class="video-container">
          <video id="player" class="w-full h-full object-cover" playsinline autoplay muted></video>

          <div id="live-tag" class="hidden absolute top-4 left-4 z-40 px-2 py-1 bg-red-600 rounded text-[10px] font-black flex items-center gap-1.5 status-dot">
            <span class="w-1.5 h-1.5 bg-white rounded-full"></span> LIVE
          </div>

          <div class="absolute bottom-0 left-0 right-0 p-5 bg-gradient-to-t from-black via-black/80 to-transparent">
            <span id="cam-category" class="text-[9px] font-bold text-blue-400 uppercase tracking-widest block mb-1">Source Standby</span>
            <h2 id="cam-name" class="text-lg lg:text-xl font-bold text-white truncate uppercase">Pilih Lokasi Monitoring</h2>
          </div>

          <div id="loader" class="hidden absolute inset-0 flex items-center justify-center bg-slate-950/90 z-50">
            <div class="flex flex-col items-center">
              <div class="w-10 h-10 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mb-3"></div>
              <p class="text-[10px] font-mono text-blue-400 uppercase tracking-widest">Accessing Stream...</p>
            </div>
          </div>
        </div>
      </div>

      <div id="retry-container" class="absolute bottom-32 w-full flex justify-center z-50">
        <button id="retry-btn" onclick="app.retry()" class="hidden px-8 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-full text-[11px] font-bold tracking-widest shadow-xl transition-all active:scale-95">RECONNECT SIGNAL</button>
      </div>
    </section>

    <aside class="w-full lg:w-80 bg-slate-900 border-l border-slate-800 flex flex-col h-[45vh] lg:h-full flex-shrink-0">
      <div class="p-4 bg-slate-900 border-b border-slate-800">
        <input type="text" id="search" placeholder="Cari Lokasi..." class="w-full bg-slate-950 border border-slate-700 rounded-lg px-4 py-2.5 text-xs focus:ring-1 focus:ring-blue-500 outline-none text-white">
      </div>

      <div id="sidebar-list" class="flex-1 overflow-y-auto custom-scroll p-3 space-y-2">
      </div>
    </aside>
  </main>

  <div id="modal" class="fixed inset-0 bg-black/95 backdrop-blur-md z-[100] hidden items-center justify-center p-6">
    <div class="bg-slate-900 border border-slate-800 w-full max-w-md rounded-2xl p-6">
      <h3 class="text-lg font-bold mb-2">Override Link</h3>
      <input type="text" id="manual-url" placeholder="https://.../stream.m3u8" class="w-full bg-black border border-slate-700 rounded-xl px-4 py-3 text-xs text-blue-400 font-mono mb-6 outline-none">
      <div class="flex gap-2">
        <button onclick="app.applyManual()" class="flex-1 bg-blue-600 py-3 rounded-xl font-bold text-xs uppercase tracking-widest">Apply</button>
        <button onclick="app.toggleSettings()" class="flex-1 bg-slate-800 py-3 rounded-xl font-bold text-xs uppercase tracking-widest">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    // DATABASE LENGKAP TANPA ADA YANG DIHILANGKAN
    const CATEGORIES = [{
        id: 'bic',
        name: 'Kawasan Bic',
        icon: 'ðŸ™ï¸',
        subs: [{
            name: 'ISL',
            url: 'https://cctv.jasamarga.com/hls/pasteur.m3u8'
          },
          {
            name: 'FURUKAWA',
            url: 'https://cctv.jasamarga.com/hls/cileunyi.m3u8'
          },
          {
            name: 'SARIROTI',
            url: 'https://cctv.bandung.go.id/hls/pasupati.m3u8'
          },
          {
            name: 'INDOMARCO',
            url: 'https://cctv.jasamarga.com/hls/gedebage.m3u8'
          },
          {
            name: 'HINO',
            url: 'https://cctv.jasamarga.com/hls/buahbatu.m3u8'
          }
        ]
      },
      {
        id: 'cikampek',
        name: 'Cikampek ~ Bks',
        icon: 'ðŸ›£ï¸',
        subs: [{
            name: 'Cikopo',
            url: 'https://jmlive.jasamarga.com/hls/5/ed6734ac-1cde-4afd-acf9-2658f8e7a254/index.m3u8'
          },
          {
            name: 'Klari Krwg',
            url: 'https://its.binamarga.pu.go.id:8989/play/hls/CT-09/index.m3u8'
          },
          {
            name: 'Simpang Dawuan',
            url: 'https://its.binamarga.pu.go.id:8989/play/hls/CT-10/index.m3u8'
          },
          {
            name: 'Krw Barat',
            url: 'https://its.binamarga.pu.go.id:8989/play/hls/CT-08/index.m3u8'
          },
          {
            name: 'Tambun',
            url: 'https://its.binamarga.pu.go.id:8989/play/hls/CT-01/index.m3u8'
          },
          {
            name: 'Cikarang Barat',
            url: 'https://its.binamarga.pu.go.id:8989/play/hls/CT-04/index.m3u8'
          }
        ]
      },
      {
        id: 'japek',
        name: 'TOL JAPEK',
        icon: 'ðŸ›£ï¸',
        subs: [{
            name: 'KM 10 Cikunir',
            url: 'https://cctv.jasamarga.com/hls/km10.m3u8'
          },
          {
            name: 'KM 21 Tambun',
            url: 'https://cctv.jasamarga.com/hls/km21.m3u8'
          },
          {
            name: 'KM 31 Cikarang',
            url: 'https://cctv.jasamarga.com/hls/km31.m3u8'
          },
          {
            name: 'KM 47 Karawang',
            url: 'https://cctv.jasamarga.com/hls/km47.m3u8'
          },
          {
            name: 'Layang MBZ',
            url: 'https://cctv.jasamarga.com/hls/mbz.m3u8'
          }
        ]
      },
      {
        id: 'tangmer',
        name: 'Tangerang',
        icon: 'ðŸšš',
        subs: [{
            name: 'Bitung',
            url: 'https://cctv-dishub.tangerangkab.go.id/storage/video/01jzvr0hphd8c104283f8g1d9n/01jzvr0hphd8c104283f8g1d9n.m3u8?t=1772043503004'
          },
          {
            name: 'Balaraja Barat',
            url: 'https://cctv.mms-corp.id/balbar-exit/index.m3u8'
          },
          {
            name: 'Exit Merak',
            url: 'https://cctv.mms-corp.id/merak-exit/index.m3u8'
          },
          {
            name: 'Serang Timur',
            url: 'https://cctv.astratol.co.id/hls/serang.m3u8'
          },
          {
            name: 'Cilegon Barat',
            url: 'https://cctv.astratol.co.id/hls/cilegon.m3u8'
          }
        ]
      },
      {
        id: 'merak',
        name: 'MERAK',
        icon: 'ðŸš¢',
        subs: [{
            name: 'Dermaga Eksekutif',
            url: 'https://stream.asdp.id/hls/merak-eksekutif.m3u8'
          },
          {
            name: 'Dermaga 1',
            url: 'https://stream.asdp.id/hls/merak1.m3u8'
          },
          {
            name: 'Dermaga 2',
            url: 'https://stream.asdp.id/hls/merak2.m3u8'
          },
          {
            name: 'Pintu Masuk Port',
            url: 'https://stream.asdp.id/hls/gate-merak.m3u8'
          },
          {
            name: 'Area Parkir',
            url: 'https://stream.asdp.id/hls/parkir-merak.m3u8'
          }
        ]
      },
      {
        id: 'bojonegara',
        name: 'BOJONEGARA',
        icon: 'âš“',
        subs: [{
            name: 'Gate Utama',
            url: 'https://cctv.pelindo.co.id/bojonegara1.m3u8'
          },
          {
            name: 'Area Logistik',
            url: 'https://cctv.pelindo.co.id/bojonegara2.m3u8'
          },
          {
            name: 'Dermaga',
            url: 'https://cctv.pelindo.co.id/bojonegara3.m3u8'
          },
          {
            name: 'Jalur Akses',
            url: 'https://cctv.pelindo.co.id/bojonegara4.m3u8'
          },
          {
            name: 'Pergudangan',
            url: 'https://cctv.pelindo.co.id/bojonegara5.m3u8'
          }
        ]
      },
      {
        id: 'indramayu',
        name: 'INDRAMAYU',
        icon: 'ðŸŒ¾',
        subs: [{
            name: 'Sasak Sewo',
            url: 'https://streamer.indramayukab.go.id/memfs/4bb80c7d-72d5-47d2-a10e-b4fde7862205.m3u8'
          },
          {
            name: 'Jatibarang',
            url: 'https://dishub.indramayukab.go.id/jatibarang.m3u8'
          },
          {
            name: 'Karangampel',
            url: 'https://dishub.indramayukab.go.id/karangampel.m3u8'
          },
          {
            name: 'Eretan',
            url: 'https://streamer.indramayukab.go.id/memfs/4bb80c7d-72d5-47d2-a10e-b4fde7862205.m3u8'
          }
        ]
      },
      {
        id: 'cirebon',
        name: 'CIREBON',
        icon: 'ðŸ¯',
        subs: [{
            name: 'Plumbon',
            url: 'https://cctv.jasamarga.com/hls/plumbon.m3u8'
          },
          {
            name: 'Kanci',
            url: 'https://cctv.jasamarga.com/hls/kanci.m3u8'
          },
          {
            name: 'Palimanan',
            url: 'https://cctv.jasamarga.com/hls/palimanan.m3u8'
          }
        ]
      },
      {
        id: 'surabaya',
        name: 'SURABAYA',
        icon: 'ðŸ¦ˆ',
        subs: [{
            name: 'Waru',
            url: 'https://cctv.jasamarga.com/hls/waru.m3u8'
          },
          {
            name: 'Gunung Sari',
            url: 'https://cctv.jasamarga.com/hls/gunungsari.m3u8'
          },
          {
            name: 'Suramadu',
            url: 'https://dishub.surabaya.go.id/suramadu.m3u8'
          }
        ]
      },
      {
        id: 'medan',
        name: 'MEDAN',
        icon: 'ðŸ¢',
        subs: [{
            name: 'Amplas',
            url: 'https://atcs.medan.id/hls/amplas.m3u8'
          },
          {
            name: 'Belawan',
            url: 'https://cctv.jasamarga.com/hls/belawan.m3u8'
          },
          {
            name: 'Simpang Pos',
            url: 'https://atcs.medan.id/hls/simpangpos.m3u8'
          }
        ]
      }
    ];
    class MonitorApp {
      constructor() {
        this.player = document.getElementById('player');
        this.loader = document.getElementById('loader');
        this.hls = null;
        this.currentSource = {
          url: '',
          name: '',
          cat: ''
        };
        this.init();
      }
      init() {
        this.renderMenu(CATEGORIES);
        this.setupSearch();
      }
      renderMenu(data) {
        const container = document.getElementById('sidebar-list');
        container.innerHTML = data.map(item => `
          <div class="bg-slate-800/40 rounded-xl overflow-hidden border border-slate-700/50">
            <button onclick="app.toggleSub('${item.id}')" class="w-full p-4 flex items-center justify-between hover:bg-slate-700/60 transition-all">
              <div class="flex items-center gap-3">
                <span>${item.icon}</span>
                <span class="text-[11px] font-bold uppercase tracking-wider">${item.name}</span>
              </div>
              <svg id="icon-${item.id}" class="w-3 h-3 text-slate-500 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 9l-7 7-7-7" stroke-width="3"/></svg>
            </button>
            <div id="sub-${item.id}" class="submenu px-2">
              ${item.subs.map(sub => `
                <button onclick="app.play('${sub.url}', '${sub.name}', '${item.name}', this)" class="w-full text-left px-4 py-3 text-[10px] font-semibold text-slate-400 hover:text-blue-400 hover:bg-blue-500/5 rounded-lg flex items-center gap-3">
                  <span class="w-1 h-1 bg-slate-600 rounded-full"></span> ${sub.name}
                </button>
              `).join('')}
            </div>
          </div>
        `).join('');
      }
      toggleSub(id) {
        const el = document.getElementById(`sub-${id}`);
        const icon = document.getElementById(`icon-${id}`);
        const isOpen = el.classList.contains('open');
        document.querySelectorAll('.submenu').forEach(s => s.classList.remove('open'));
        document.querySelectorAll('.transition-transform').forEach(i => i.style.transform = 'rotate(0deg)');
        if (!isOpen) {
          el.classList.add('open');
          icon.style.transform = 'rotate(180deg)';
        }
      }
      async play(url, name, cat, btn = null) {
        try {
          this.currentSource = {
            url,
            name,
            cat
          };
          this.loader.classList.remove('hidden');
          document.getElementById('retry-btn').classList.add('hidden');
          document.getElementById('cam-name').innerText = name;
          document.getElementById('cam-category').innerText = cat;
          if (btn) {
            document.querySelectorAll('#sidebar-list button').forEach(b => b.classList.remove('text-blue-500', 'bg-blue-500/10'));
            btn.classList.add('text-blue-500', 'bg-blue-500/10');
          }
          if (this.hls) this.hls.destroy();
          if (Hls.isSupported()) {
            this.hls = new Hls({
              maxBufferLength: 30
            });
            this.hls.loadSource(url);
            this.hls.attachMedia(this.player);
            this.hls.on(Hls.Events.MANIFEST_PARSED, () => {
              this.player.play();
              this.loader.classList.add('hidden');
              document.getElementById('live-tag').classList.remove('hidden');
            });
            this.hls.on(Hls.Events.ERROR, (e, data) => {
              if (data.fatal) this.handleError();
            });
          } else if (this.player.canPlayType('application/vnd.apple.mpegurl')) {
            this.player.src = url;
            this.player.addEventListener('loadedmetadata', () => {
              this.player.play();
              this.loader.classList.add('hidden');
            });
          }
        } catch (e) {
          this.handleError();
        }
      }
      handleError() {
        this.loader.classList.add('hidden');
        document.getElementById('retry-btn').classList.remove('hidden');
        document.getElementById('live-tag').classList.add('hidden');
      }
      retry() {
        this.play(this.currentSource.url, this.currentSource.name, this.currentSource.cat);
      }
      setupSearch() {
        document.getElementById('search').addEventListener('input', (e) => {
          const q = e.target.value.toLowerCase();
          document.querySelectorAll('#sidebar-list > div').forEach(el => {
            el.style.display = el.textContent.toLowerCase().includes(q) ? 'block' : 'none';
          });
        });
      }
      toggleSettings() {
        document.getElementById('modal').classList.toggle('hidden');
        document.getElementById('modal').classList.toggle('flex');
      }
      applyManual() {
        const url = document.getElementById('manual-url').value;
        if (url) {
          this.play(url, "OVERRIDE", "MANUAL");
          this.toggleSettings();
        }
      }
    }
    const app = new MonitorApp();
  </script>
</body>

</html>
